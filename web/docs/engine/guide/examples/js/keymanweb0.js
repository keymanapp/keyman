/*(C) Copyright 1994-2008 Tavultesoft Pty Ltd. All Rights Reserved. Details: keymanweb.com*/
if(typeof(KeymanWeb_Root)=='undefined')var KeymanWeb_Root='';if(typeof(KeymanWeb_AttachType)=='undefined')var KeymanWeb_AttachType='auto';if(typeof(KeymanWeb_ControlDownColor)=='undefined')var KeymanWeb_ControlDownColor='#e0e0e0';if(typeof(KeymanWeb_KeyDownColor)=='undefined')var KeymanWeb_KeyDownColor='#c0c0ff';if(typeof(KeymanWeb_KeyHoverColor)=='undefined')var KeymanWeb_KeyHoverColor='#e0e0ff';if(typeof(KeymanWeb_DefaultKeyboardName)=='undefined')var KeymanWeb_DefaultKeyboardName='English';if(typeof(KeymanWeb_DefaultKeyboardHelp)=='undefined')var KeymanWeb_DefaultKeyboardHelp='Select a keyboard layout from the dropdown box above';var KeymanWeb;new CKeymanWeb();function CKeymanWeb(){var f=this;KeymanWeb=this;f.Build=142;f.Version='1.0';f.cx=0;with(navigator.appVersion)if(typeof(document.createEventObject)=='undefined'&&document.selection&&(indexOf('MSIE 5.0')>=0||indexOf('MSIE 4.0')>=0||indexOf('MSIE 3.0')>=0))f.bt=1;else f.bt=0;f.cX=(navigator.userAgent.indexOf('AppleWebKit')>=0);if(typeof(KeymanWeb_BaseLayout)==='undefined')f.bo='us';else f.bo=KeymanWeb_BaseLayout;f.ab="KeymanWeb_VK_";f.aD=1;f.ag=[];f.aq=[];f.bI=[];f.C=[];f.ShowInterfaceRight=0;f.aS=0;f.bu=null;f.A=null;f.bx=1;f.cB=null;f.ar=null;f.ap=0;f.D=function(m,PUnselectable){var e=document.createElement(m);return PUnselectable?KeymanWeb.eh(e):e;};f.M=f.D('DIV');f.ea=null;f.bK=function(e){if(!e)e=window.event;if(e&&e.preventDefault)e.preventDefault();e.cancelBubble=true;return false;};f.cz=function(){var f=KeymanWeb;var l=f.D('DIV');var o=l.style;o.paddingLeft='2px';o.cursor='move';o.background='#ad4a28';o.font='bold 8pt sans-serif';var K=f.D('IMG');o=K.style;o.position='absolute';o.right='0';o.top='1px';o.display='block';o.marginRight='2px';o.cursor='pointer';K.src=KeymanWeb_Root+"kmwclose.gif";K.onmousedown=f.bK;K.onclick=function(){var f=KeymanWeb;f.HideHelp();if(f.onoskhidehelp)f.onoskhidehelp();};l.appendChild(K);f.UnpinHelp=function(){var f=KeymanWeb;if(f.aS)f.ShowHelpAuto();if(f.onresizemove)f.onresizemove();};K=f.cv=f.D('IMG');o=K.style;o.display='none';o.position='absolute';o.right='22px';o.top='1px';o.cursor='pointer';K.src=KeymanWeb_Root+"kmwunpin.gif";K.onclick=f.UnpinHelp;K.onmousedown=f.bK;l.appendChild(K);K=f.D('SPAN');o=K.style;o.color='white';K.innerHTML='Tavultesoft KeymanWeb';f.ea=K;l.appendChild(K);return l;};f.T=f.D('DIV');f.at=f.D('IMG');f.U=f.D('SELECT');f.bq=null;f.ak=[];var V=f.D('OPTION'),_v,_va,dA=0xedb88320,R,al='',as,bT,cQ=[],dE;as=unescape('cJ%01XS_IQYRH%12PS_%5DHUSR%12TSOHR%5DQY%07J%5DN%1CcM%1C%01%1C%0CD_%0D%0F%08%5E%08%09%0F%07');V.value='-';V.innerHTML=KeymanWeb_DefaultKeyboardName;f.U.appendChild(V);V=null;f.HelpURL='http://help.keymanweb.com/go';f.aV=null;f.aa=0;f.af=0;f.P=null;f.L=[];f.bd='automatic';f.onblurcontrol=f.onfocuscontrol=null;if(typeof(KeymanWeb_onkeyboardloaded)!='undefined')f.onkeyboardloaded=KeymanWeb_onkeyboardloaded;else f.onkeyboardloaded=null;if(typeof(KeymanWeb_onkeyboardchange)!='undefined')f.onkeyboardchange=KeymanWeb_onkeyboardchange;else f.onkeyboardchange=null;for(R=0;R<as.length;R++)al+=String.fromCharCode(as.charCodeAt(R)^0x3c);var bf;f.aw=0;f.dM=[];f.bR=[];eval(al);f.ah=function(aX,cq){if(aX.push)aX.push(cq);else aX=aX.concat(cq);return aX;};f.IsHelpVisible=function(){return KeymanWeb.aS;};f.GetEnabled=function(){return KeymanWeb.aD;};f.SetEnabled=function(aP){var f=KeymanWeb;if(aP)aP=1;else aP=0;if(f.aD!=aP){f.aD=aP;if(!aP)f.bO();}};f.ShowHelpAuto=function(){var f=KeymanWeb,cR=f.onshowhelp||f.bw;f.cu=false;cR(f.GetAbsoluteX(f.T),f.GetAbsoluteY(f.T)+f.T.offsetHeight);if(f.cv)f.cv.style.display='none';};f.ShowPinnedHelp=function(){var f=KeymanWeb,cR=f.onshowhelp||f.bw;cR(-1,-1);};f.ShowHelp=function(Px,cW){KeymanWeb.bw(Px,cW);};f.HideHelp=function(){KeymanWeb.cw();};f.DisableControl=function(g){var f=KeymanWeb,Ln,Lc;for(Ln=0;Ln<f.L.length;Ln++)if(f.L[Ln].aG==g){f.L[Ln].az=0;return;}Lc={aG:g,az:0,am:'-'};f.L=f.ah(f.L,Lc);};f.EnableControl=function(g){var f=KeymanWeb,Ln,Lc;for(Ln=0;Ln<f.L.length;Ln++)if(f.L[Ln].aG==g){f.L[Ln].az=1;return;}Lc={aG:g,az:1,am:'-'};f.L=f.ah(f.L,Lc);};var cP=_v;for(R=0;R<256;R++){for(as=0,al=R;as<8;as++){bT=((al&0xfffffffe)/2)&0x7fffffff;al=(al&1)?bT^dA:bT;}cQ[R]=al;}al='';as=unescape('cJ%01HELYSZ%14wYEQ%5DRkY%5EcwYE%15%01%01%1EOHNUR%5B%1E%1A%1AwYEQ%5DRkY%5EcwYE%12URXYDsZ%14%14cJb%0CDZZZZZZZZbcJ%5D%15%15%1D%01%11%0D%07');f.SetDefaultKeyboardForControl=function(g,dZ){var f=KeymanWeb,Ln,Lc;for(Ln=0;Ln<f.L.length;Ln++)if(f.L[Ln].aG==g){f.L[Ln].am=dZ;return;}Lc={aG:g,az:1,am:dZ};f.L=f.ah(f.L,Lc);};f.GetHelpPos=function(){var f=KeymanWeb,O=f.M;return{left:O.offsetLeft,top:O.offsetTop,width:f.bx,offsetWidth:f.bq?f.bS:O.offsetWidth};};f.SetHelpPos=function(x,y){var f=KeymanWeb,o=f.M.style;o.left=x+'px';o.top=y+'px';f.cu=true;if(f.cv)f.cv.style.display='block';};f.SetHelpSize=function(w){var f=KeymanWeb;f.bx=w>4?4:(w<0.1?0.1:w);if(f.bq)f.bq.style.fontSize=f.bx+'em';};f.bw=function(x,y){var dbw=document.body.offsetWidth;var f=KeymanWeb,o=f.M.style;if(x>=0){o.left=x+'px';o.top=y+'px';}o.display='block';if(f.bq)f.dR(f.bq,f.dQ,f.dS);else f.dR(f.M,f.dQ);if(f.cu){if(f.cv)f.cv.style.display='block';}else if(f.bq){if(f.M.offsetLeft+f.bq.offsetWidth>=dbw)o.left=(dbw-f.bq.offsetWidth)+'px';}else if(f.M.offsetLeft+f.M.offsetWidth>=dbw)o.left=(dbw-f.M.offsetWidth)+'px';f.aS=1;o=f.at.style;o.border='inset 1px #808080';o.background='#f7e7de';if(f.bq)f.bS=f.bq.offsetWidth;};f.dR=function(e,q,x){if(q)try{with(q.style){left=f.GetAbsoluteX(e)+'px';top=f.GetAbsoluteY(e)+'px';if(x){width=(f.GetAbsoluteX(x)-f.GetAbsoluteX(e)+x.offsetWidth)+"px";height=(f.GetAbsoluteY(x)-f.GetAbsoluteY(e)+x.offsetHeight)+"px";}else{width=e.offsetWidth+"px";height=e.offsetHeight+"px";}zindex='99';display='block';}}catch(e){}};f.dT=function(q){try{if(q)q.style.display='none';}catch(e){}};dE='';f.cw=function(){var f=KeymanWeb,o=f.at.style;f.M.style.display='none';f.aS=0;o.border='none';o.background='white';f.dT(f.dQ);};f.aR=function(){var f=KeymanWeb;if(!f.aV)return;f.af=1;if(f.ba(f.aV))f.aV.defaultView.focus();else if(f.aV.focus)f.aV.focus();};f.FocusLastActiveElement=function(){KeymanWeb.aR();};f.GetLastActiveElement=function(){return KeymanWeb.aV;};f.Help=function(){var f=KeymanWeb,k=f.T;if(f.aS)f.cw();else f.bw(f.GetAbsoluteX(k),f.GetAbsoluteY(k)+k.offsetHeight);if(f.aV!=null){f.aa=1;f.af=1;f.aR();}};f.UIState=function(){var f=KeymanWeb;return f.aa|(f.af<<1);};f.SetMode=function(value){if(value=='manual'||value=='automatic')KeymanWeb.bd=value;};f.GetMode=function(){return KeymanWeb.bd;};f.IsInterfaceVisible=function(){return KeymanWeb.T.style.display=='block';};f.ShowInterface=function(x,y){var f=KeymanWeb;if(!x|| !y||f.bd!='manual')return 0;return f.cE(x,y);};f.cE=function(x,y){var f=KeymanWeb,o=f.T.style;if(x&&y){o.left=x+'px';o.top=y+'px';}o.display='block';f.at.style.left=f.U.offsetWidth+28+'px';o.width=f.U.offsetWidth+59+'px';if(f.aS)if(!f.cu)f.ShowHelpAuto();else f.ShowPinnedHelp();};f.HideInterface=function(){KeymanWeb.bO();};f.bO=function(){var f=KeymanWeb;f.T.style.display='none';f.M.style.display='none';f.dT(f.dQ);f.aV=null;};bf=_q;f.bp=function(e){var f=KeymanWeb,k,Ln;if(!f.aD)return true;if(!e)e=window.event;if(e.target)k=e.target;else if(e.srcElement)k=e.srcElement;else return true;if(k.nodeType==3)k=k.parentNode;if(k.tagName=='IFRAME'){f.cr(k);k=k.contentWindow.document;}f.P=null;f.aV=k;for(Ln=0;Ln<f.L.length;Ln++)if(f.L[Ln].aG==k){f.P=f.L[Ln];break;}if(f.P!=null&&f.P.am!=null)if(!f.af){f.bv(f.P.am);}else f.P.am=f.A==null?'':f.A.KI;if(!f.cy(k,1)|| !f.ba(k,1)){f.bM=1;return true;}f.bM=0;if(!f.af)f.C=[];if(!f.af&&f.cB!=k)f.aa=0;f.af=0;f.cB=k;k._KeymanWebSelectionStart=null;k._KeymanWebSelectionEnd=null;f.cD(k);if(f.onfocuscontrol)f.onfocuscontrol(k);if(f.bd!='automatic')return true;f.aV=null;if(f.P==null||f.P.az){if(f.cy(k))k=k.ownerDocument.parentWindow.frameElement;else if(f.ba(k))k=k.defaultView.frameElement;if(f.ShowInterfaceRight)f.cE(f.GetAbsoluteX(k)+k.offsetWidth+1,f.GetAbsoluteY(k)+1);else f.cE(f.GetAbsoluteX(k)+1,f.GetAbsoluteY(k)+k.offsetHeight+1);}f.bs=1;};f.bs=0;f.cy=function(g,aZ){var t,aW=g&&(t=g.tagName)&&t.toLowerCase()=='body'&&(t=g.ownerDocument)&&t.parentWindow;return(!aZ&&aW)||(aZ&&(!aW||g.isContentEditable));};for(R=0;R<cP.length;R++)bf=cQ[(bf^cP.charCodeAt(R))&0xff]^(bf>>>8);f.ba=function(g,aZ){var t,aW=g&&(t=g.defaultView)&&t.frameElement;return(!aZ&&aW)||(aZ&&(!aW||t.document.designMode.toLowerCase()=='on'));};f.bL=function(e){var f=KeymanWeb,k;if(!f.aD)return true;if(!e)e=window.event;if(e.target)k=e.target;else if(e.srcElement)k=e.srcElement;else return true;if(k.nodeType==3)k=k.parentNode;if(k.tagName=='IFRAME')k=k.contentWindow.document;if(k.setSelectionRange){k._KeymanWebSelectionStart=k.selectionStart;k._KeymanWebSelectionEnd=k.selectionEnd;}f.aV=k;if(f.P!=null&&f.P.am!=null)if(f.A==null)f.P.am='';else f.P.am=f.A.KI;f.P=null;if(f.onblurcontrol)f.onblurcontrol(k);if(f.bd!='automatic')return true;if(!e)e=window.event;if(!f.aa)f.bO();};_v=bf;dE+=as;for(R=0;R<dE.length;R++)al+=String.fromCharCode(dE.charCodeAt(R)^0x3c);f.ct=function(e){};f.cF={k109:189,k61:187,k59:186};f.dC={};f.dD={};f.dj={se:{k220:192,k187:189,k219:187,k221:219,k186:221,k191:220,k192:186,k189:191},uk:{k223:192,k192:222,k222:226,k220:220}};f.cs={se:'§1234567890+´~~~QWERTYUIOPÅ¨\'~~~ASDFGHJKLÖÄ~~~~~<ZXCVBNM,.-~~~~~ ',uk:'`1234567890-=~~~QWERTYUIOP[]#~~~ASDFGHJKL;\'~~~~~\\ZXCVBNM,./~~~~~ '};f.bN=function(e){var s=new Object(),f=KeymanWeb;if(!e)e=window.event;if(e.target)s.k=e.target;else if(e.srcElement)s.k=e.srcElement;else return null;if(s.k.nodeType==3)s.k=s.k.parentNode;if(e.keyCode)s.G=e.keyCode;else if(e.which)s.G=e.which;else return null;if(e.shiftKey!=null)s.ad=(e.shiftKey?0x10:0)|(e.ctrlKey?(e.ctrlLeft?0x20:0x20):0)|(e.altKey?(e.altLeft?0x40:0x40):0);else s.ad=((e.modifiers&1)==1?0x40:0)|((e.modifiers&2)==2?0x20:0)|((e.modifiers&4)==4?0x10:0);s.cS=(e.charCode!=null&&(e.charCode==0||(s.ad&0x60)!=0));s.aK=s.cS||e.type!='keypress';return s;};f.dc=function(e){var f=KeymanWeb;if(f.ap){f.ap--;}else{var o=document.selection;if(o.type.toLowerCase()!='control'){var dX=o.createRange();if(!f.ar|| !f.ar.isEqual(dX)){f.ar=dX;f.C=[];}}}return true;};f.dh=new Array({k192:96,k49:49,k50:50,k51:51,k52:52,k53:53,k54:54,k55:55,k56:56,k57:57,k48:48,k189:45,k187:61,k81:113,k87:119,k69:101,k82:114,k84:116,k89:121,k85:117,k73:105,k79:111,k80:112,k219:91,k221:93,k220:92,k65:97,k83:115,k68:100,k70:102,k71:103,k72:104,k74:106,k75:107,k76:108,k186:59,k222:39,k90:122,k88:120,k67:99,k86:118,k66:98,k78:110,k77:109,k188:44,k190:46,k191:47},{k192:126,k49:33,k50:64,k51:35,k52:36,k53:37,k54:94,k55:38,k56:42,k57:40,k48:41,k189:95,k187:43,k81:81,k87:87,k69:69,k82:82,k84:84,k89:89,k85:85,k73:73,k79:79,k80:80,k219:123,k221:125,k220:124,k65:65,k83:83,k68:68,k70:70,k71:71,k72:72,k74:74,k75:75,k76:76,k186:58,k222:34,k90:90,k88:88,k67:67,k86:86,k66:66,k78:78,k77:77,k188:60,k190:62,k191:63});f.di=function(r){return KeymanWeb.dh[r.ad&0x10?1:0]['k'+r.G];};f.ee=function(g){var f=KeymanWeb;if(!g.createTextRange&&g.selectionStart){var r=document.createEvent('KeyboardEvent');if(r.initKeyEvent){r.initKeyEvent('keypress',true,true,null,false,false,false,false,0,32);var LkeyPress=f.bc;f.bc=function(){};g.dispatchEvent(r);r=document.createEvent('KeyboardEvent');r.initKeyEvent('keypress',true,true,null,false,false,false,false,8,0);g.dispatchEvent(r);f.bc=LkeyPress;}}};f.bb=function(e){var f=KeymanWeb;f.aF=0;if(!f.aD||f.bM||f.A==null||(f.P!=null&& !f.P.az))return true;var r=f.bN(e);if(r==null)return true;switch(r.G){case 16:case 17:case 18:return f.bQ(r,r.G-15,1);}if((t=r.k.ownerDocument)&&(t=t.selection)&&(r.G<33||r.G>40)){t.createRange().select();}if(!window.event){if(f.cF['k'+r.G])r.G=f.cF['k'+r.G];}if(!f.A.KM){var aI=0;var by=f.dj[f.bo];if(by&&by['k'+r.G])r.G=by['k'+r.G];if(typeof(f.A.KM)=='undefined'&& !(r.ad&0x60)){var bZ={G:f.di(r),k:r.k,ad:0,aK:0};if(f.A.gs(bZ.k,bZ))aI=1;}aI=aI||f.A.gs(r.k,r);}else{if(r.G==8){f.aF=1;f.A.gs(r.k,r);}else f.aF=0;}if(!aI&&r.G>=96&&r.G<=111){if(r.G<106)var aH=r.G-48;else aH=r.G-64;f.KO(0,r.k,String.fromCharCode(aH));aI=1;}if(aI){f.ee(r.k);if(e&&e.preventDefault)e.preventDefault();f.aF=(e?e.keyCode:0);return false;}else f.aF=0;return true;};eval(al);f.bc=function(e){var f=KeymanWeb,r;if(!f.aD||f.bM||f.A==null||(f.P!=null&& !f.P.az))return true;r=f.bN(e);if(r==null||r.aK)return true;if(!f.A.KM){if(!f.aF)return true;if(r.G<0x20||(f.cX&&(r.G>0xF700&&r.G<0xF900)))return true;if(window.event)window.event.returnValue=false;return false;}if(f.aF||f.A.gs(r.k,r)){f.aF=0;if(e&&e.preventDefault)e.preventDefault();f.ee(r.k);return false;}f.aF=0;return true;};f.ax=function(e){var f=KeymanWeb,r=f.bN(e);if(r==null)return true;switch(r.G){case 16:case 17:case 18:return f.bQ(r,r.G-15,1);}var t;if((t=r.k.ownerDocument)&&(t=t.selection)&&t.type!='control'){t=t.createRange();f.ar=t;}};f.Q=function(g,aM,aN,bn){var f=KeymanWeb;f.cY(g,aM,aN,bn);if(g.attachEvent)g.attachEvent('on'+aM,aN);else if(g.addEventListener)g.addEventListener(aM,aN,bn?true:false);var r={m:g,aU:aM,aJ:aN,cg:bn?true:false};f.ak=f.ah(f.ak,r);};if(!_v)f.bb=f.ax;if(!_v)f.bc=f.ax;f.eb=[];f.ec=function(g){var f=KeymanWeb;for(var i=0;i<f.eb.length;i++)if(f.eb[i]==g)return 1;return 0;};f.cY=function(g,aM,aN,bn){var f=KeymanWeb;var Ln,H;for(Ln=0;Ln<f.ak.length;Ln++){H=f.ak[Ln];if(H.aU==aM&&H.m==g&&H.aJ==aN){if(H.m.detachEvent)H.m.detachEvent('on'+H.aU,H.aJ);else if(H.m.removeEventListener)H.m.removeEventListener(H.aU,H.aJ,H.cg);f.ak=f.ak.slice(0,parseInt(Ln)).concat(f.ak.slice(parseInt(Ln)+1));break;}}};f.AttachToControl=function(g){var f=KeymanWeb;if(g.tagName.toLowerCase()=='iframe')f.cr(g);else{f.Q(g,'focus',f.bp);f.Q(g,'blur',f.bL);g.onkeypress=f.bc;g.onkeydown=f.bb;g.onkeyup=f.ax;}if(!f.ec(g))f.eb.push(g);};f.cr=function(g){try{var f=KeymanWeb;var m=g.contentWindow.document;if(m){if(m.parentWindow){if(m.designMode.toLowerCase()=='on'||m.body.isTextEdit){f.Q(g,'focus',f.bp);f.Q(g,'blur',f.bL);if(!f.bt){f.Q(m,'selectionchange',f.dc);f.dc();}}}else{f.Q(m,'focus',f.bp);f.Q(m,'blur',f.bL);}f.Q(m,'keydown',f.bb);f.Q(m,'keypress',f.bc);f.Q(m,'keyup',f.ax);}}catch(err){}};f.cC=function(e){KeymanWeb.aa=1;};f.df=function(e){KeymanWeb.aa=1;};f.de=function(e){KeymanWeb.aa=0;};f.db=function(e){var f=KeymanWeb;if(f.U.value!='-')f.bv(f.U.value);else f.bv('');if(f.aV!=null){f.aR();}};f.bv=function(ao){var f=KeymanWeb,Ln;if(f.A&&f.A.KI==ao)return true;f.A=null;for(Ln=0;Ln<f.ag.length;Ln++)if(f.ag[Ln].KI==ao){f.A=f.ag[Ln];break;}if(f.A==null){for(Ln=0;Ln<f.aq.length;Ln++)if(f.aq[Ln].KI==ao){f.U.value=ao;f.bu=ao;var bG=f.D('SCRIPT');var Lfilename=f.aq[Ln].KF;if(!Lfilename.match(/[/ \\]/))Lfilename=KeymanWeb_Root+Lfilename;bG.src=Lfilename;bG.type='text/javascript';document.body.appendChild(bG);return;}f.U.value='-';}else f.U.value=ao;f.bP();};if(!_v)f.bc=f.ax;if(!_v)f.bb=f.ax;f._w=_v;f.SetActiveKeyboard=function(ao){var f=KeymanWeb;f.bv(ao);f.U.value=ao;if(f.onkeyboardchange!=null)f.onkeyboardchange(ao);};f.GetActiveKeyboard=function(){var f=KeymanWeb;if(f.A==null)return '';return f.A.KI;};f.GetKeyboards=function(){var f=KeymanWeb,Lr=[],Ln,av,O,bE,bg,bh;for(Ln=0;Ln<f.ag.length;Ln++){O=f.ag[Ln];bh={Name:O.KN,InternalName:O.KI,LanguageName:O.KL};Lr=f.ah(Lr,bh);}for(Ln=0;Ln<f.aq.length;Ln++){av=f.aq[Ln];bg=0;for(bE=0;bE<f.ag.length;bE++)if(f.ag[bE].KI==av.KI){bg=1;break;}if(!bg){bh={Name:av.KN,InternalName:av.KI,LanguageName:av.KL,LanguageCode:av.KLC,RegionName:av.KR,RegionCode:av.KRC,CountryName:av.KC,CountryCode:av.KCC};Lr=f.ah(Lr,bh);}}return Lr;};var LoutsideBorder='solid 1px #ad4a28';f.cV=function(J,bW,aj,aL,cj,r){var f=KeymanWeb,B=f.D('DIV',1),o=B.style,l=f.D('SPAN',1);o.width=aL+'%';o.left=aj+'%';o.position='absolute';o.height='100%';o.overflow='hidden';if(r&&o.cursor)o.cursor='default';if(aj==0)o.borderLeft=LoutsideBorder;else if(aj+aL==94)o.borderRight=LoutsideBorder;if(f.cs[f.bo]&&bW=='Enter')o.borderTop='none';B.KWCC='';B.KMWC=f.ab+(cj?'4':'5')+' '+f.ab+(cj?'Spacer':'Control');B.className=B.KMWC;o=l.style;o.position='absolute';o.left='5%';o.top='5%';if(r&&o.cursor)o.cursor='default';l.innerHTML=bW;if(r){B.onmousedown=f.cG;B.onmouseover=f.cI;B.onmouseout=f.cH;B.onmouseup=f.cJ;B.onclick=f.dz;B.KWSC=r;}B.appendChild(l);J.appendChild(B);return B;};f.ay=null;f.be=function(e){var k;if(!e)e=window.event;if(e.target)k=e.target;else if(e.srcElement)k=e.srcElement;else return null;if(k.nodeType==3)k=k.parentNode;if(k.tagName=='SPAN')k=k.parentNode;return k;};f.dq=function(e){var f=KeymanWeb,k=f.be(e),m=f.aV,o,aT,ai,dY;if(m!=null){o=m._KeymanWebSelectionStart;aT=m._KeymanWebSelectionEnd;dY=f.ar;f.bs=0;f.aa=1;f.ap=100;f.aR();if(f.ba(m))m=m.documentElement;if(document.selection&&dY!=null)dY.select();m._KeymanWebSelectionStart=o;m._KeymanWebSelectionEnd=aT;f.ap=0;if(!f.A.KM){ai=k.keyCode;ai.ad=f.aw*0x10;ai.k=m;if(!f.A.gs(m,ai))f.KO(0,m,String.fromCharCode(k.charCode[f.aw].G));}else{ai=k.charCode[f.aw];ai.k=m;if(!f.A.gs(m,ai))f.KO(0,m,String.fromCharCode(ai.G));}m._KeymanWebSelectionStart=null;m._KeymanWebSelectionEnd=null;}};f.bQ=function(e,v,d){var f=KeymanWeb;if(e)f.aw=e.ad/0x10;else if(d)f.aw|=v;else f.aw&= ~v;for(var j=0;j<3;j++)f.dg(j,(f.aw&(1<<j))==0?'':KeymanWeb_ControlDownColor);for(j=0;j<8;j++){var bi=(f.aw==j)?'inline':'none';for(var Ln=0;Ln<64;Ln++){var m=f.bR[Ln+j*65];if(m)m.style.display=bi;}}return true;};f.dg=function(j,Lc){var f=KeymanWeb;if(f.dM.length<=j*2+1)return;f.dM[j*2].KWCC=Lc;f.dM[j*2+1].KWCC=Lc;f.dM[j*2].style.backgroundColor=Lc;f.dM[j*2+1].style.backgroundColor=Lc;};f.dz=function(e){var f=KeymanWeb,k=f.be(e);var dY=f.ar;f.bs=0;f.aa=1;f.ap=100;f.aR();if(document.selection&&dY!=null)dY.select();f.bQ(null,k.KWSC,(f.aw&k.KWSC)==0);};f.cG=function(e){var f=KeymanWeb;f.ap=1;f.ay=f.be(e);if(f.ay!=null)f.ay.style.backgroundColor=KeymanWeb_KeyDownColor;};f.cI=function(e){var f=KeymanWeb;var k=f.be(e);if(k!=null)if(k==f.ay)k.style.backgroundColor=KeymanWeb_KeyDownColor;else k.style.backgroundColor=KeymanWeb_KeyHoverColor;};f.cH=function(e){var f=KeymanWeb;var k=f.be(e);if(k!=null)k.style.backgroundColor=k.KWCC;};f.cJ=function(e){var f=KeymanWeb;if(f.ay!=null)f.ay.style.backgroundColor=f.ay.KWCC;f.ay=null;};f.dP=function(e){return e.replace('&','&amp;').replace('<','&lt;').replace('>','&gt;');};f.BuildVisualKeyboard=function(ao,PStatic){var f=KeymanWeb,PKbd,Ln;if(ao){for(Ln=0;Ln<f.ag.length;Ln++)if(f.ag[Ln].KI==ao){PKbd=f.ag[Ln];break;}}else PKbd=f.A;if(!PKbd)return null;return f.ef(PKbd.KV,PKbd.KI,PStatic);};f.ef=function(bk,KI,PStatic){var f=KeymanWeb;if(f.cs[f.bo]){var aE=6,bj=f.cs[f.bo];}else{var aE=0,bj='`1234567890-=~~~QWERTYUIOP[]\\~~~ASDFGHJKL;\'~~~~~?ZXCVBNM,./~~~~~ ';}var cT='\xc0'+'1234567890\xbd\xbb~~~QWERTYUIOP\xdb\xdd\xdc~~~ASDFGHJKL\xba\xde~~~~~\xe2ZXCVBNM\xbc\xbe\xbf~~~~~ ',ck='`1234567890-=~~~qwertyuiop[]\\~~~asdfghjkl;\'~~~~~?zxcvbnm,./~~~~~ '+'~!@#$%^&*()_+~~~QWERTYUIOP{}|~~~ASDFGHJKL:"~~~~~?ZXCVBNM<>?~~~~~ ';var J=null,B,aj,aL,l,aH,an=f.D('DIV',1);for(var j=0;j<65;j++){if(j%16==0){J=f.D('DIV',1);an.appendChild(J);s=J.style;s.cursor='default';s.position='relative';s.height='1.8em';s.left=0;s.width='100%';s.top='0';switch(j/16){case 0:aj=0;f.cV(J,'Backspace',78,16);break;case 1:aj=10;f.cV(J,'Tab',0,10);if(aE>0)f.cV(J,'',82,12);break;case 2:aj=12;f.cV(J,'Caps Lock',0,12);f.cV(J,'Enter',78+aE,16-aE);break;case 3:if(bk.K102){aj=9;f.dM[0]=f.cV(J,'Shift',0,9,0,1);}else{aj=15.0;f.dM[0]=f.cV(J,'Shift',0,15,0,1);}f.dM[1]=f.cV(J,'Shift',75,19,0,1);break;case 4:f.dM[2]=f.cV(J,'Ctrl',0,10,0,2);f.dM[4]=f.cV(J,'Alt',18,10,0,4);f.cV(J,'',10,8,1);f.dM[5]=f.cV(J,'Alt',68,10,0,4);f.cV(J,'',78,8,1);f.dM[3]=f.cV(J,'Ctrl',84,10,0,2);aj=28;break;}}if(j==28&&aE>0)continue;if(j==43&&aE>0){var ca=1;j=28;}else var ca=0;aH=bj.charAt(j);if(aH!='~'&&(j!=48||bk.K102)){B=f.D('DIV',1);B.KWCC='';B.KMWC=f.ab+'3 '+f.ab+'Key';B.className=B.KMWC;J.appendChild(B);if(j==28&&aE==0)aL=12;else if(j==64)aL=40;else aL=6;with(B.style){width=aL+'%';left=aj+'%';if(cursor)cursor='default';position='absolute';height='100%';if(aj==0)borderLeft=LoutsideBorder;else if(aj+aL==94)borderRight=LoutsideBorder;overflow='hidden';}if(!PStatic){B.onmousedown=f.cG;B.onmouseover=f.cI;B.onmouseout=f.cH;B.onmouseup=f.cJ;B.onclick=f.dq;}B.charCode=[];for(var i=0;i<7;i++)B.charCode=f.ah(B.charCode,{G:ck.length>i*bj.length?ck.charCodeAt(j+i*bj.length):0,ad:0,aK:0});B.keyCode={G:cT.charCodeAt(j),ad:0,aK:1};aj+=6;l=f.D('SPAN',1);with(l.style){if(cursor)cursor='default';position='absolute';left='5%';top='5%';}l.innerHTML=aH;l.className=f.ab+'0 '+f.ab+'Cap';l.id=f.ab+'Cap_'+j;B.appendChild(l);for(i=0;i<8;i++){l=f.D('SPAN',1);with(l.style){if(cursor)cursor='default';position='absolute';right='8%';bottom='5%';if(i>0)display='none';}f.bR[i*65+j]=l;l.className=f.ab+'1 '+f.ab+'Char '+f.ab+'Char_'+KI;l.id=f.ab+'Char_'+KI+(i*65+j);var bV=bk.BK[i*65+j];if(typeof(bV)!='undefined')l.innerHTML=f.dP(bV);B.appendChild(l);}B.appendChild(l);}if(ca)j=43;}var s=an.style;s.position='relative';s.width='27em';s.height='9em';return an;};f.eh=function(g){if(typeof g.onselectstart!="undefined")g.onselectstart=function(){return false;};else with(g.style){MozUserSelect="none";KhtmlUserSelect="none";UserSelect="none";}return g;};f.cZ=function(bk,aA){var f=KeymanWeb;var l,an=f.ef(bk,f.A.KI);var O=f.D('DIV',1),s=O.style;s.position='absolute';s.left=0;s.top=0;s.width='25.38em';s.height='9em';s.textAlign='left';s.font=bk.F;s.fontSize=f.bx+'em';l=f.D('DIV');l.style.position='relative';l.style.width='25.38em';l.style.border='solid 1px #ad4a28';l.appendChild(f.cz());l.onmousedown=f.cK;O.appendChild(l);O.appendChild(an);l=f.D('DIV');s=l.style;s.cursor='se-resize';s.position='absolute';s.right='0';s.bottom='0';s.width='12px';s.height='12px';s.overflow='hidden';s.background='url('+KeymanWeb_Root+'kmwresize.gif)';l.onmousedown=f.dv;l.title='Resize On Screen Keyboard';l.onmouseover=f.dy;l.onmouseout=f.dx;f.dM[3].appendChild(l);l=f.D('DIV');if(aA==''){s=l.style;l.innerHTML='<a target="_blank" href="'+f.HelpURL+'?keyboard='+f.A.KI+'">Help on this keyboard</a>';s.position='absolute';s.left='2px';s.height='16px';s.overflowY='hidden';s.font='12px sans-serif';}else{l.innerHTML=aA;s=l.style;s.textAlign='left';s.padding='4px 16px 4px 4px';s.font='12px sans-serif';s=an.style;s.height='auto';s.overflowY='visible';if(f.A.KHF)f.A.KHF(l);}var an=f.D('DIV');s=an.style;s.position='relative';s.left=0;s.top='0em';s.width='25.38em';s.height='16px';an.className=f.ab+'Help';an.appendChild(l);f.dS=an;O.appendChild(an);f.bq=O;f.M.appendChild(O);f.bS=O.offsetWidth;};f.dm=function(e){KeymanWeb.aa=1;};f.dk=function(e){KeymanWeb.aa=0;};f.dy=f.dx=function(e){KeymanWeb.aa=1;if(!e)e=window.event;if(e&&e.preventDefault)e.preventDefault();e.cancelBubble=true;return false;};f.dv=function(e){var f=KeymanWeb;f.af=1;if(!e)e=window.event;if(e.pageX)var dW=e.pageX;else if(e.clientX)dW=e.clientX+document.body.scrollLeft;f.da=dW;if(document.onmousemove!=f.dw&&document.onmousemove!=f.dr){f.dO=document.onmousemove;f.cN=document.onmouseup;}f.cL=document.body.style.cursor;f.dN=(typeof(e.which)=='undefined'?e.button:e.which);f.bS=f.bq.offsetWidth;f.dp=f.bx;document.onmousemove=f.dw;document.onmouseup=f.cO;if(document.body.style.cursor)document.body.style.cursor='se-resize';if(e&&e.preventDefault)e.preventDefault();e.cancelBubble=true;return false;};f.dw=function(e){var f=KeymanWeb,dW;if(!e)var e=window.event;if(f.dN!=(typeof(e.which)=='undefined'?e.button:e.which)){return f.cO(e);}else{if(e.pageX)dW=e.pageX;else if(e.clientX)dW=e.clientX+document.body.scrollLeft;f.bx=f.dp*(f.bS+dW-f.da)/(f.bS);f.bq.style.fontSize=f.bx+'em';f.dR(f.bq,f.dQ,f.dS);if(e&&e.preventDefault)e.preventDefault();e.cancelBubble=true;return false;}};f.cK=function(e){var f=KeymanWeb,dW,aB;f.af=1;if(!e)e=window.event;if(e.pageX){dW=e.pageX;aB=e.pageY;}else if(e.clientX){dW=e.clientX+document.body.scrollLeft;aB=e.clientY+document.body.scrollTop;}if(document.onmousemove!=f.dw&&document.onmousemove!=f.dr){f.dO=document.onmousemove;f.cN=document.onmouseup;}f.cL=document.body.style.cursor;f.dN=(typeof(e.which)=='undefined'?e.button:e.which);f.ds=dW-f.M.offsetLeft;f.du=aB-f.M.offsetTop;f.cu=true;if(f.cv)f.cv.style.display='block';document.onmousemove=f.dr;document.onmouseup=f.cO;if(document.body.style.cursor)document.body.style.cursor='move';if(e&&e.preventDefault)e.preventDefault();e.cancelBubble=true;return false;};f.HelpIsPinned=function(){return KeymanWeb.cu;};f.dr=function(e){var f=KeymanWeb,dW,aB;if(!e)var e=window.event;if(f.dN!=(typeof(e.which)=='undefined'?e.button:e.which)){return f.cO(e);}else{if(e.pageX){dW=e.pageX;aB=e.pageY;}else if(e.clientX){dW=e.clientX+document.body.scrollLeft;aB=e.clientY+document.body.scrollTop;}f.M.style.left=(dW-f.ds)+'px';f.M.style.top=(aB-f.du)+'px';if(f.bq)f.dR(f.bq,f.dQ,f.dS);else f.dR(f.M,f.dQ);if(e&&e.preventDefault)e.preventDefault();e.cancelBubble=true;return false;}};f.cO=function(e){var f=KeymanWeb;if(!e)var e=window.event;document.onmousemove=f.dO;document.onmouseup=f.cN;if(document.body.style.cursor)document.body.style.cursor=f.cL;f.aR();if(e&&e.preventDefault)e.preventDefault();f.af=0;f.aa=0;if(f.bq)f.bS=f.bq.offsetWidth;if(f.onresizemove)f.onresizemove();e.cancelBubble=true;return false;};f.bP=function(){var f=KeymanWeb;if(f.ea)f.ea.innerHTML='Tavultesoft KeymanWeb';f.bq=f.dS=null;f.M.innerHTML='';if(f.A==null){var l=f.D('DIV');l.style.border='solid 1px #ad4a28';l.style.background='white';l.innerHTML=KeymanWeb_DefaultKeyboardHelp;f.M.appendChild(l);}else{var ci=f.A.KV;var aA=f.A.KH;if(ci!=null)f.cZ(ci,aA);else{l=f.D('DIV');l.style.position='static';l.style.border='solid 1px #ad4a28';l.appendChild(f.cz());l.onmousedown=f.cK;f.M.appendChild(l);if(aA=='')aA='No help is available for this keyboard';var l=f.D('div');l.style.textAlign='left';l.style.font='12 px sans-serif';l.style.border='solid 1px #ad4a28';l.innerHTML=aA;f.M.appendChild(l);if(f.A.KHF)f.A.KHF(f.M);}if(f.ea)f.ea.innerHTML+=' - '+f.A.KN;}};f.dB=function(){var f=KeymanWeb,Ln,H;for(Ln=0;Ln<f.ak.length;Ln++){H=f.ak[Ln];try{if(H.m.detachEvent)H.m.detachEvent('on'+H.aU,H.aJ);else H.m.removeEventListener(H.aU,H.aJ,H.cg);if(H.aJ==f.bp)H.m.onkeypress=H.m.onkeydown=H.m.onkeyup=null;}catch(err){}H.m=0;}f.ak=f.dM=f.U=f.M=f.T=f.at=f.aV=f.bq=f.bR=0;};f.Init=function(){KeymanWeb.bU();};f.eg=function(g){var j=function(x){return g.getElementsByTagName(x);},bC=j('INPUT'),cf=j('TEXTAREA'),bA=j('IFRAME');for(j=0;j<bC.length;j++)if(bC[j].type.toLowerCase()=='text')f.AttachToControl(bC[j]);for(j=0;j<cf.length;j++)f.AttachToControl(cf[j]);for(j=0;j<bA.length;j++)try{if(bA[j].contentWindow.document)f.cr(bA[j]);}catch(err){}};f.bU=function(){var f=KeymanWeb;if(f.cx)return;f.cx=1;if(window.removeEventListener)window.removeEventListener('focus',f.ct,true);if(KeymanWeb_AttachType!='manual'){f.eg(document);}var bg,O,av,Ln,bE,s=f.M.style;s.zIndex=100;s.display='none';s.position='absolute';s.fontSize='12pt';if(!f._w)f.bb=f.ax;s=f.U.style;s.font='8pt sans-serif';s.backgroundColor='#f3e5de';s.border='solid 1px #7B9EBD';s.height='18px';s.margin='2px';s.left='24px';s.top='0px';s.position='absolute';f.bP();var bD=f.D('DIV');f.T.innerHTML="<a href='http://help.keymanweb.com/' target='_blank'><img src='"+KeymanWeb_Root+"kmicon.png' border='0' style='padding: 2px' title='KeymanWeb' alt='KeymanWeb' /></a>";s=f.T.style;s.backgroundColor='white';s.border='solid 1px black';s.position='absolute';s.height='24px';s.font='bold 8pt sans-serif';s.display='none';s.textAlign='left';s.overflow='hidden';if(!f._w)f.bc=f.ax;f.Q(f.T,'mousedown',f.cC);f.Q(f.M,'mousedown',f.cC);f.Q(f.T,'mouseover',f.df);f.Q(f.T,'mouseout',f.de);f.Q(f.U,'change',f.db);var bB=f.D('A'),s=f.at.style;bB.href='javascript:KeymanWeb.Help()';f.at.src=KeymanWeb_Root+'kbdicon.gif';f.at.title='Display visual keyboard';f.at.border='0';s.width='24px';s.height='13px';s.top='2px';s.verticalAlign='bottom';s.padding='3px 2px 2px 2px';s.position='absolute';bD.appendChild(f.U);bB.appendChild(f.at);bD.appendChild(bB);f.T.appendChild(bD);if(window.createPopup&& !window.XmlHttpRequest){f.dQ=f.dU();f.dV=f.dU();}with(document.body){appendChild(f.T);if(f.dV)appendChild(f.dV);appendChild(f.M);if(f.dQ)appendChild(f.dQ);}if(document.selection&& !f.bt)f.Q(document,'selectionchange',f.dc);};f.dU=function(){var f=KeymanWeb,e=f.D('iframe');with(e){src='';style.display='none';style.position='absolute';style.filter='progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)';frameBorder='0';scrolling='no';}return e;};f.GetAbsoluteX=function(aY){var bX=aY.offsetLeft,ae=aY;if(ae.offsetParent){while(ae.offsetParent){ae=ae.offsetParent;bX+=ae.offsetLeft;}}return bX;};f.GetAbsoluteY=function(aY){var bY=aY.offsetTop,ae=aY;if(ae.offsetParent){while(ae.offsetParent){ae=ae.offsetParent;bY+=ae.offsetTop;}}return bY;};f.cA=function(g){var t;if(g._KeymanWebSelectionStart)return g._KeymanWebSelectionStart;else if(g.setSelectionRange)return g.selectionStart;else if((t=g.ownerDocument)&&(t=t.defaultView)&&t.getSelection&&g.ownerDocument.designMode.toLowerCase()=='on'){var dY=t.getSelection();if(dY.focusNode.nodeType==3)return dY.focusOffset;}return 0;};f.cD=function(aC){var f=KeymanWeb;if(f.A==null)aC.dir='ltr';else if(f.A.KRTL)aC.dir='rtl';else aC.dir='ltr';};f.KSF=function(){KeymanWeb.ap=1;};f.KT=function(cp,cl){var f=KeymanWeb,m=f.aV,o,aT,ai,dY,bi=false;if(m!=null){o=m._KeymanWebSelectionStart;aT=m._KeymanWebSelectionEnd;dY=f.ar;f.bs=0;f.aa=1;f.ap=100;f.aR();if(f.ba(m))m=m.documentElement;if(document.selection&&dY!=null)dY.select();m._KeymanWebSelectionStart=o;m._KeymanWebSelectionEnd=aT;f.ap=0;if(cp!=null)f.KO(0,m,cp);if(typeof(cl)!='undefined')f.KDO(0,m,cl);m._KeymanWebSelectionStart=null;m._KeymanWebSelectionEnd=null;bi=true;}return bi;};f.KR=function(aO){var f=KeymanWeb;var av;f.ag=f.ah(f.ag,aO);for(av=0;av<f.aq.length;av++)if(aO.KI==f.aq[av].KI){if(f.bu==aO.KI){f.A=aO;f.bP();if(f.aV!=null){f.af=1;f.cD(f.aV);}}f.bu=null;aO.KL=f.aq[av].KL;if(f.onkeyboardloaded!=null)f.onkeyboardloaded(aO.KI);return 1;}f.bu=null;var V=f.D('OPTION');V.value=aO.KI;V.innerHTML=(aO.KL?(aO.KL+' '):'')+aO.KN;f.U.appendChild(V);V=null;};f.KRS=function(bm){var f=KeymanWeb;var cc;for(cc=0;cc<f.ag.length;cc++)if(f.ag[cc].KI==bm.KI)return 1;f.aq=f.ah(f.aq,bm);var V=f.D('OPTION');V.value=bm.KI;V.innerHTML=(bm.KL?(bm.KL+' '):'')+bm.KN;f.U.appendChild(V);V=null;};f.KC=function(n,ln,g){var f=KeymanWeb,t;if(g.body)var dF=g;else var dF=g.ownerDocument;if(f.bt){return g.value.substr(g.length-n,ln);}else if(dF&&(t=dF.defaultView)&&t.getSelection&&dF.designMode.toLowerCase()=='on'){var dY=t.getSelection();if(dY.focusNode.nodeType==3)return dY.focusNode.substringData(n<dY.focusOffset?dY.focusOffset-n:0,n<dY.focusOffset?ln:dY.focusOffset);else return "";}else if(g.setSelectionRange){var I,au;if(g._KeymanWebSelectionStart){I=g._KeymanWebSelectionStart;au=g._KeymanWebSelectionEnd;}else{I=g.selectionStart;au=g.selectionEnd;}if(I<n){return g.value.substring(0,I);}return g.value.substring(I-n,I-n+ln);}else if(dF&&(t=dF.selection)){var dX=t.createRange();dX.moveStart('character',-n);return dX.text.substring(0,ln);}return "";};f.KCM=function(n,aC,val,ln){return this.KC(n,ln,aC)==val;};f.KIK=function(e){if(KeymanWeb.A.KM)return!e.aK;return KeymanWeb.di(e)?1:0;};f.KKM=function(e,bF,cd){if(e.aK){if((bF&0x4000)==0x4000){return(cd==e.G&&(bF&0x7F)==e.ad)}}else if((bF&0x4000)==0){return e.G==cd;}return 0;};f.KKI=function(e){return{vk:e.aK,code:e.G,modifiers:e.ad};};f.KDM=function(n,aC,d){var f=KeymanWeb;if(!document.selection)n=f.cA(aC)-n;for(var i=0;i<f.C.length;i++)if(f.C[i].p==n&&f.C[i].d==d){return 1;}return false;};f.aQ=[];f.bJ=0;f.KBR=function(){var f=KeymanWeb,bz;f.bJ=0;for(bz=0;bz<f.aQ.length;bz++){f.aQ[bz].e.style.backgroundColor=f.aQ[bz].c;}f.aQ=[];};f.KB=function(g){var f=KeymanWeb;if(g.body)g=g.body;if(!g.style||typeof(g.style.backgroundColor)=='undefined')return;for(bz=0;bz<f.aQ.length;bz++){if(f.aQ[bz].e==g)return;}f.aQ=f.ah(f.aQ,{e:g,c:g.style.backgroundColor});g.style.backgroundColor='#000000';if(f.bJ==0){f.bJ=1;window.setTimeout(f.KBR,50);}};f.KA=function(n,ch,s){if(ch=='')return 0;var cb=s.indexOf(ch);KeymanWeb.bI[n]=cb;return cb>=0;};f.dG=function(dK){var dJ={'backcolor':1,'fontname':1,'fontsize':1,'forecolor':1,'bold':0,'italic':0,'strikethrough':0,'subscript':0,'superscript':0,'underline':0},dI;if(dK.defaultView)dJ['hilitecolor']=1;for(var dI=0;dI<dJ.length;dI++){if(dJ[dI])dJ[dI]={a:1,b:dK.queryCommandValue(dI)};else dJ[dI]={a:0,b:dK.queryCommandState(dI)};}return dJ;};f.dH=function(dK,dJ,dL){for(var dI=0;dI<dJ.length;dI++){if(dJ[dI].a){if(dK.queryCommandValue(dI)!=dJ[dI].b){if(dL)dL();dK.execCommand(dI,false,dJ[dI].b);}}else if(dK.queryCommandState(dI)!=dJ[dI].b){if(dL)dL();dK.execCommand(dI,false,null);}}};f.KO=function(dn,g,s){var f=KeymanWeb;if(g.body)var dF=g;else var dF=g.ownerDocument;var j,t;if(f.bt){if(dn>0)g.value=g.value.substr(0,g.value.length-dn)+s;else g.value=g.value+s;}else if(dF&&(t=dF.defaultView)&&t.getSelection&&dF.designMode.toLowerCase()=='on'){var dJ=f.dG(dF);var dY=t.getSelection(),I=dY.focusOffset;var dX=dY.getRangeAt(0);if(dn>0)dX.setStart(dY.focusNode,dY.focusOffset-dn);dX.deleteContents();if(dY.focusNode.nodeType==3){dY.focusNode.insertData(dY.focusOffset,s);dY.extend(dY.focusNode,dY.focusOffset+s.length);}else{var n=dF.createTextNode(s);dX.insertNode(n);dY.extend(n,s.length);}f.dH(dF,dJ,null);dY.collapseToEnd();for(j=0;j<f.C.length;){if(f.C[j].p>I-dn&&f.C[j].p<=I){if(j>0)ac=f.C.slice(0,j-1);else ac=[];if(j<f.C.length-1)ac.concat(f.C.slice(j+1));f.C=ac;}else if(f.C[j].p>I)f.C[j].p+= -dn+s.length;j++;}}else if(g.setSelectionRange){var I,au;if(g._KeymanWebSelectionStart){I=g._KeymanWebSelectionStart;au=g._KeymanWebSelectionEnd;}else{I=g.selectionStart;au=g.selectionEnd;}var bH,ce;if(g.type.toLowerCase()=='textarea'&&typeof(g.scrollTop)!='undefined'){bH=g.scrollTop;ce=g.scrollLeft;}if(dn<0){g.value=g.value.substring(0,I)+s+g.value.substring(au);dn=0;}else if(I<dn)g.value=s+g.value.substring(au);else g.value=g.value.substring(0,I-dn)+s+g.value.substring(au);for(j=0;j<f.C.length;){if(f.C[j].p>I-dn&&f.C[j].p<=I){if(j>0)ac=f.C.slice(0,j-1);else ac=[];if(j<f.C.length-1)ac.concat(f.C.slice(j+1));f.C=ac;}else if(f.C[j].p>I)f.C[j].p+= -dn+s.length;j++;}if(typeof(bH)!='undefined'){g.scrollTop=bH;g.scrollLeft=ce;}g.setSelectionRange(I-dn+s.length,I-dn+s.length);g._KeymanWebSelectionStart=null;g._KeymanWebSelectionEnd=null;}else if(dF&&(t=dF.selection)){if(dF.body.isTextEdit||dF.designMode.toLowerCase()=='on'){var dJ=f.dG(dF);}var dX=t.createRange(),ac,j;if(dX.text!=''){t.clear();dn=0;}else dX.collapse(true);if(dn>0){dX.moveStart('character',-dn);}else dn=0;dX.text=s;if(dF.body.isTextEdit||dF.designMode.toLowerCase()=='on'){dX.moveStart('character',-s.length);f.dH(dF,dJ,dX.select);dX.moveStart('character',s.length);dX.select();}for(j=0;j<f.C.length;){if(f.C[j].p<dn){if(j>0)ac=f.C.slice(0,j-1);else ac=[];if(j<f.C.length-1)ac.concat(f.C.slice(j+1));f.C=ac;}else f.C[j].p+= -dn+s.length;j++;}f.ar=t.createRange();f.ar.select();f.ar.scrollIntoView();}};f.KDO=function(bl,g,cU){var Lc=new Object(),f=KeymanWeb;if(bl>0)f.KO(bl,g,"");Lc.p=f.cA(g);Lc.d=cU;f.C=f.ah(f.C,Lc);};f.KIO=function(bl,co,cn,g){var f=KeymanWeb;if(f.bI[cn-1]<co.length)f.KO(bl,g,co.charAt(f.bI[cn-1]));};f.M.onmouseover=f.dm;f.M.onmouseout=f.dk;f.Q(window,'load',f.bU);f.Q(window,'unload',f.dB);if(window.addEventListener)window.addEventListener('focus',f.ct,true);f.ei=function(){var g=window.event.srcElement;if(g!=null&& !KeymanWeb.ec(g))with(g)if((tagName.toLowerCase()=='input'&&type.toLowerCase()=='text')||tagName.toLowerCase()=='textarea'||tagName.toLowerCase()=='iframe')KeymanWeb.AttachToControl(g);};f.ej=function(e){var g=e.target;if(g!=null&&g.nodeType==1)KeymanWeb.eg(g);};if(KeymanWeb_AttachType!='manual'){if(document.attachEvent)document.attachEvent('onfocusin',f.ei);else if(document.addEventListener)document.addEventListener('DOMNodeInserted',f.ej,1);}f.ed=function(){if(!KeymanWeb.aa)KeymanWeb.bQ(null,15,0);};f.Q(window,'focus',f.ed);f.Q(window,'blur',f.ed);document.writeln("<style type='text/css'>"+".KeymanWeb_VK_0{font: bold 0.6em sans-serif;color:#c0c0c0}"+".KeymanWeb_VK_1{color:blue}"+".KeymanWeb_VK_2{background-color:white;border:1px solid black}"+".KeymanWeb_VK_3{background:white;border:solid 1px #808080}"+".KeymanWeb_VK_4{background:white;border:solid 1px #808080}"+".KeymanWeb_VK_5{background:#c0c0c0;border:solid 1px #808080;font:bold 0.5em sans-serif;color:#808080}"+".KeymanWeb_VK_6{background:#e0e0e0}"+".KeymanWeb_VK_7{background:#c0c0ff}"+".KeymanWeb_VK_8{background-color:#e0e0ff}"+".KeymanWeb_VK_Help{border: solid 1px #ad4a28; background: white }"+"</style>");}
