----------------------------------------------------------------------------------------------------
@@JvHttpGrabber.pas
Note:
<B>Delphi Versions:</B> <COLOR Brown>5, 6</COLOR> <B> 

C++ Builder Versions:</B> <COLOR Brown>none</COLOR>

Conditions:
The contents of this file are subject to the Mozilla Public License Version 1.1 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.mozilla.org/MPL/MPL-1.1.html

Author:
Sébastien Buysse

Version:
1.20 Beta

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber
Description:
This component is able to download a file on an http server in a separated thread. In other words, it will download a file from the web without disturbing your Application. It will only tell you the progression, the possible errors and when it has finished. 
To use this component with C++Builder, you have to add WinInet.lib to your project !!! (Currently C++Builder is not supported by JVCL)

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.FAgent

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.FFileName

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.FOnClosed

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.FOnClosing

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.FOnConnected

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.FOnConnecting

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.FOnDoneFile

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.FOnDoneStream

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.FOnError

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.FOnProgress

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.FOnReceived

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.FOnReceiving

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.FOnRedirect

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.FOnRequest

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.FOnResolved

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.FOnResolving

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.FOnSending

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.FOnSent

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.FOnStateChange

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.FOutputMode

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.FPassword

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.FReferer

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.FThread

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.FUrl

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.FUsername

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.Abort
Description:
Use this method to abort the current download (if any).

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.Create@TComponent

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.Destroy

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.DoneFile@TObject@string@Integer@string

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.DoneStream@TObject@TStream@Integer@string

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.Error@TObject@string

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.Execute
Description:
Call this method to start downloading the given URL.

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.GetWorking

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.Progress@TObject@Integer@Integer@string@Boolean

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.Status@TObject@Integer@string

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.ThreadFinished@TObject

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.Agent
Description:
This property contains the agent sended to the web server. The agent identifies the application connecting to the server (You can simulate you are Internet Explorer or Netscape).

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.FileName
Description:
This property contains the name of the file in which the data is saved. If you want to use a stream instead, you must set the OutputMode to omStream. When the filename has been created and saved, the event OnDoneFile is fired.

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.OnClosedConnection
Description:
This event is called when the connection with the server has been closed.

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.OnClosingConnection
Description:
This event is called when the connection with the server is about to be closed.

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.OnConnectedToServer
Description:
This event is called when the connection with the server has been established.

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.OnConnectingToServer
Description:
This event is called when the connection with the server is about to be started.

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.OnDoneFile
Description:
This event is called when the file has been successfully dowloaded and saved to a file. This event is only called when you have set the OutputMode to omFile.

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.OnDoneStream
Description:
This event is called when the file has been successfully downloaded and saved to a stream. This event is only called when you have set the OutputMode to omStream

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.OnError
Description:
This event is called when an error occured. The error can be either a problem with the connection, an inexistant server or any other error. The download is automatically aborted.

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.OnProgress
Description:
This event is called when some bytes of the file have been downloaded. This event is the most usefull one to display progression bar, to compute time remaining, etc.

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.OnReceivedResponse
Description:
This event is called when the server has finished sending the file.

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.OnReceivingResponse
Description:
This event is called when the server has started sending the answer

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.OnRedirect
Description:
This event is called when the web server is redirecting your request to another url. This event will give you the new url.

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.OnRequestComplete
Description:
This event is called when the request you have sent has been successfully completed.

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.OnRequestSent
Description:
This event is called when the request has been completly sent

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.OnResolvedName
Description:
This event is called when the hostname has been successfully translated into his address. The request is now going to be processed.

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.OnResolvingName
Description:
This event is called when the hostname is going to be translated into his address. When this request is terminated, the event OnResolvedName is fired.

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.OnSendingRequest
Description:
This event is called when the request is going to be sent to server.

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.OnStateChange
Description:
This event is called when the connection state has changed (offline/online)

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.OutputMode
Description:
This property specify the destination of the downloaded file. It can be either a stream or a file.
 If you want to save it to a stream, set this property to omStream, then, when the file will be downloaded, the event OnDoneStream will be fired.
 If you want to save it directly to a file, set this property to omFile and specify a valid filename in the property FileName (The event OnDoneFile will be fired when the file has been created)

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.Password
Description:
This property contains the password used to identify yourself on the server. If no password has to be given, just left this property blank.

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.Referer
Description:
This property contains the URL referring the one you are surfing to. This URL is used by servers to make some stats. By example, you are at http://delphi-jedi.org and you click on a link to http://www.borland.com, the referrer should be http://delphi-jedi.org

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.Url
Description:
This property is the location of the file on the web. (ex : http://www.yourserver.com/yourfile.ext)

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.Username
Description:
This property contains the username used to identify yourself on the server. If no username has to be given, just left this property blank.

----------------------------------------------------------------------------------------------------
@@TJvHttpGrabber.Working

----------------------------------------------------------------------------------------------------
@@TJvHttpThread

----------------------------------------------------------------------------------------------------
@@TJvHttpThread.FAgent

----------------------------------------------------------------------------------------------------
@@TJvHttpThread.FBytesReaded

----------------------------------------------------------------------------------------------------
@@TJvHttpThread.FContinue

----------------------------------------------------------------------------------------------------
@@TJvHttpThread.FErrorText

----------------------------------------------------------------------------------------------------
@@TJvHttpThread.FFileName

----------------------------------------------------------------------------------------------------
@@TJvHttpThread.FOnDoneFile

----------------------------------------------------------------------------------------------------
@@TJvHttpThread.FOnDoneStream

----------------------------------------------------------------------------------------------------
@@TJvHttpThread.FOnError

----------------------------------------------------------------------------------------------------
@@TJvHttpThread.FOnProgress

----------------------------------------------------------------------------------------------------
@@TJvHttpThread.FOnStatus

----------------------------------------------------------------------------------------------------
@@TJvHttpThread.FOutputMode

----------------------------------------------------------------------------------------------------
@@TJvHttpThread.FPassword

----------------------------------------------------------------------------------------------------
@@TJvHttpThread.FReferer

----------------------------------------------------------------------------------------------------
@@TJvHttpThread.FStream

----------------------------------------------------------------------------------------------------
@@TJvHttpThread.FTotalBytes

----------------------------------------------------------------------------------------------------
@@TJvHttpThread.FUrl

----------------------------------------------------------------------------------------------------
@@TJvHttpThread.FUsername

----------------------------------------------------------------------------------------------------
@@TJvHttpThread.Create@string@string@string@string@string@TJvOutputMode@TOnError@TOnDoneFile@TOnDone

----------------------------------------------------------------------------------------------------
@@TJvHttpThread.Ended

----------------------------------------------------------------------------------------------------
@@TJvHttpThread.Error

----------------------------------------------------------------------------------------------------
@@TJvHttpThread.Execute

----------------------------------------------------------------------------------------------------
@@TJvHttpThread.GetLastErrorMsg

----------------------------------------------------------------------------------------------------
@@TJvHttpThread.Progress

