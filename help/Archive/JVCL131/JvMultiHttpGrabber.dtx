----------------------------------------------------------------------------------------------------
@@JvMultiHttpGrabber.pas
Note:
<B>Delphi Versions:</B> <COLOR Brown>5, 6</COLOR> <B> 

C++ Builder Versions:</B> <COLOR Brown>none</COLOR>

Conditions:
The contents of this file are subject to the Mozilla Public License Version 1.1 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.mozilla.org/MPL/MPL-1.1.html

Author:
Sébastien Buysse

Version:
1.20 Beta

----------------------------------------------------------------------------------------------------
@@TJvMultiDateHttpThread

----------------------------------------------------------------------------------------------------
@@TJvMultiDateHttpThread.FInfos

----------------------------------------------------------------------------------------------------
@@TJvMultiDateHttpThread.FValue

----------------------------------------------------------------------------------------------------
@@TJvMultiDateHttpThread.Create@Pointer

----------------------------------------------------------------------------------------------------
@@TJvMultiDateHttpThread.Error

----------------------------------------------------------------------------------------------------
@@TJvMultiDateHttpThread.Execute

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber
Description:
This component has been designed to make multiple download at the same time. All download are processed in a separated thread, and doesn't perturb your application. You application won't appear as "not responding" while downloading a file.

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.FAgent

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.FCount

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.FFileName

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.FOnClosed

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.FOnClosing

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.FOnConnected

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.FOnConnecting

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.FOnDate

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.FOnDoneFile

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.FOnDoneStream

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.FOnError

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.FOnProgress

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.FOnReceived

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.FOnReceiving

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.FOnRedirect

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.FOnRequest

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.FOnResolved

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.FOnResolving

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.FOnSending

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.FOnSent

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.FOutputMode

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.FPassword

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.FReferer

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.FUrl

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.FUsername

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.Create@TComponent

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.Download@Integer
Description:
Use this method to start downloading a file from an http server. To be able to find out which download has fired an event, you should specify a different UserData value for each of the download. (You can cast an object to an integer without any problem, as the object is just a pointer)

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.GetFileAge@Integer
Description:
Use this method to ask the date of a file. You could use this method to synchronize your file with the one of the server. When the date has been retrieved, the OnDateRetrieved event is fired. For more informations about the UserData parameter, you should see the Download method.

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.GetWorking

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.RaiseError@Pointer

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.RaiseWebError@Pointer

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.StartConnection@Integer@Boolean

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.StopConnection@Pointer

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.ThreadDateTerminated@TObject

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.ThreadTerminated@TObject

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.Agent
Description:
This property contains the agent sended to the web server. The agent identifies the application connecting to the server (You can simulate you are Internet Explorer or Netscape).

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.DownloadCount
Description:
This property contains the number of download currently active. If you want to limit your application to 10 downloads, just use this property to know when you have to refuse a new one.

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.FileName
Description:
This property contains the name of the file in which the data is saved. If you want to use a stream instead, you must set the OutputMode to omStream. When the filename has been created and saved, the event OnDoneFile is fired.

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.OnClosedConnection
Description:
This event is called when the connection with the server has been closed.

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.OnClosingConnection
Description:
This event is called when the connection with the server is about to be closed.

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.OnConnectedToServer
Description:
This event is called when the connection with the server has been established.

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.OnConnectingToServer
Description:
This event is called when the connection with the server is about to be started.

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.OnDateRetrieved
Description:
This event is called when the date has been retrieved from the server. The date is only retrieved if explicitly requested by calling the GetFileAge method.

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.OnDoneFile
Description:
This event is called when the file has been successfully dowloaded and saved to a file. This event is only called when you have set the OutputMode to omFile.

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.OnDoneStream
Description:
This event is called when the file has been successfully downloaded and saved to a stream. This event is only called when you have set the OutputMode to omStream

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.OnError
Description:
This event is called when an error occured. The error can be either a problem with the connection, an inexistant server or any other error. The download is automatically aborted.

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.OnProgress
Description:
This event is called when some bytes of the file have been downloaded. This event is the most usefull one to display progression bar, to compute time remaining, etc.

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.OnReceivedResponse
Description:
This event is called when the server has finished sending the file.

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.OnReceivingResponse
Description:
This event is called when the server has started sending the answer

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.OnRedirect
Description:
This event is called when the web server is redirecting your request to another URL. This event will give you the new URL.

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.OnRequestComplete
Description:
This event is called when the request you have sent has been successfully completed.

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.OnRequestSent
Description:
This event is called when the request has been completly sent

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.OnResolvedName
Description:
This event is called when the hostname has been successfully translated into his address. The request is now going to be processed.

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.OnResolvingName
Description:
This event is called when the hostname is going to be translated into his address. When this request is terminated, the event OnResolvedName is fired.

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.OnSendingRequest
Description:
This event is called when the request is going to be sent to server.

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.OutputMode
Description:
This property specify the destination of the downloaded file. It can be either a stream or a file.
 If you want to save it to a stream, set this property to omStream, then, when the file will be downloaded, the event OnDoneStream will be fired.
 If you want to save it directly to a file, set this property to omFile and specify a valid filename in the property FileName (The event OnDoneFile will be fired when the file has been created)

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.Password
Description:
This property contains the password used to identify yourself on the server. If no password has to be given, just left this property blank.

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.Referer
Description:
This property contains the URL referring the one you are surfing to. This URL is used by servers to make some stats. By example, you are at http://delphi-jedi.org and you click on a link to http://www.borland.com, the referrer should be http://delphi-jedi.org

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.Url
Description:
This property contains the url you want to download. The url must be of the type http://www.yourserver.com/directory/thefile.ext. After assigning this property, you must call the Download method to start the download of the file.

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.UserName
Description:
This property contains the username used to identify yourself on the server. If no username has to be given, just left this property blank.

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpGrabber.Working
Description:
This readonly property is usefull to determine whether there is a download or not. So, if this property is true, at least one download is active.

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpThread

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpThread.FContinue

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpThread.FInfos

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpThread.FPosition

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpThread.FStream

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpThread.Create@Pointer

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpThread.Error

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpThread.Execute

----------------------------------------------------------------------------------------------------
@@TJvMultiHttpThread.Progress

----------------------------------------------------------------------------------------------------
@@TRequestInfos

----------------------------------------------------------------------------------------------------
@@TRequestInfos.FileSize

----------------------------------------------------------------------------------------------------
@@TRequestInfos.Grabber

----------------------------------------------------------------------------------------------------
@@TRequestInfos.hHostConnect

----------------------------------------------------------------------------------------------------
@@TRequestInfos.hRequest

----------------------------------------------------------------------------------------------------
@@TRequestInfos.hSession

----------------------------------------------------------------------------------------------------
@@TRequestInfos.IgnoreMsg

----------------------------------------------------------------------------------------------------
@@TRequestInfos.OutputMode

----------------------------------------------------------------------------------------------------
@@TRequestInfos.Url

----------------------------------------------------------------------------------------------------
@@TRequestInfos.UserData

----------------------------------------------------------------------------------------------------
@@PRequestInfos

----------------------------------------------------------------------------------------------------
@@TDateEvent
Description:
This event is used when retrieving the date of a file.

Parameters:
FileDate -
is the date retrieved from the server
URL -
is the url being currently retrieving
UserData -
is the integer you have passed when starting the connection

----------------------------------------------------------------------------------------------------
@@TOnDoneFile
Description:
This type is used in the TJvHttpGrabber and TJvFtpGrabber to tell the user the file has been downloaded.

Parameters:
FileName -
is the file used for the download.
FileSize -
is the total size (in byte) of the file.
URL -
is the url from which the file has been downloaded.

----------------------------------------------------------------------------------------------------
@@TOnDoneStream
Description:
This type is used in the TJvHttpGrabber and TJvFtpGrabber to tell the user the file has been downloaded.

Parameters:
Stream -
is the stream containing the downloaded data.
StreamSize -
is the size of the file (in byte) stored in the stream.
URL -
is the url from which the file has been downloaded.

----------------------------------------------------------------------------------------------------
@@TOnProgress
Description:
This type is used in the TJvHttpGrabber to tell the user the progression of the download.

Parameters:
Continue -
is the boolean you can modify to stop the download of the file
Position -
is the current position in the download.
TotalSize -
is the total size of the file you are downloading.
URL -
is the url from which the file is downloading.

----------------------------------------------------------------------------------------------------
@@TUrlEvent
Description:
This event is the general event used in the TJvMultiHttpGrabber.

Parameters:
URL -
is the url being currently retrieved
UserData -
is the integer you have passed when starting the connection

----------------------------------------------------------------------------------------------------
@@TUrlEventError
Description:
This event is used when the component has encountered an error. The error could be a problem of connection, a problem with the web server, ... When an error occured, the download is automatically aborted.

Parameters:
Error -
is the error message you could display to your users
URL -
is the url being currently retrieved
UserData -
is the integer you have passed when starting the connection

----------------------------------------------------------------------------------------------------
@@TUrlRedirect
Description:
This event is fired when the request has been automatically redirected to another location. The new url has been catched and is stored in the NewUrl parameter.

Parameters:
NewURL -
is the new url being downloaded
URL -
is the url being currently retrieved
UserData -
is the integer you have passed when starting the connection

----------------------------------------------------------------------------------------------------
@@TUrlResolved
Description:
This event is used when the hostname has been resolved. (The hostname has been converted to an ip).

Parameters:
Name -
is the name of the server being resolved
URL -
is the url being currently retrieved
UserData -
is the integer you have passed when starting the connection

----------------------------------------------------------------------------------------------------
@@TUrlSent
Description:
This event is fired when the http request has been successfully sent to the server.

Parameters:
DataSize -
is the sent of the data sended by the request to the server
URL -
is the url being currently retrieved
UserData -
is the integer you have passed when starting the connection

----------------------------------------------------------------------------------------------------
@@RES_Agent

----------------------------------------------------------------------------------------------------
@@RES_ErrorConnection

