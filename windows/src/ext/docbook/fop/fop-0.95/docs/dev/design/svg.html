<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta content="Apache Forrest" name="Generator">
<meta name="Forrest-version" content="0.9-dev">
<meta name="Forrest-skin-name" content="pelt">
<title>FOP Design: SVG</title>
<link type="text/css" href="../../skin/basic.css" rel="stylesheet">
<link media="screen" type="text/css" href="../../skin/screen.css" rel="stylesheet">
<link media="print" type="text/css" href="../../skin/print.css" rel="stylesheet">
<link type="text/css" href="../../skin/profile.css" rel="stylesheet">
<script src="../../skin/getBlank.js" language="javascript" type="text/javascript"></script><script src="../../skin/getMenu.js" language="javascript" type="text/javascript"></script><script src="../../skin/fontsize.js" language="javascript" type="text/javascript"></script>
<link rel="shortcut icon" href="../../">
</head>
<body onload="init()">
<script type="text/javascript">ndeSetTextSize();</script>
<div id="top">
<!--+
    |header
    +-->
<div class="header">
<!--+
    |start group logo
    +-->
<div class="grouplogo">
<a href="http://xmlgraphics.apache.org/"><img class="logoImage" alt="Apache XML Graphics" src="../../images/group-logo.gif" title="Apache XML Graphics is responsible for the creation and maintenance of software for managing the conversion of XML formats to graphical output, and the creation and maintenance of related software components, based on software licensed to the Foundation"></a>
</div>
<!--+
    |end group logo
    +-->
<!--+
    |start Project Logo
    +-->
<div class="projectlogo">
<a href="http://xmlgraphics.apache.org/fop/"><img class="logoImage" alt="Apache FOP" src="../../images/logo.jpg" title="Apache FOP (Formatting Objects Processor) is the world's first output independent formatter. Output formats currently supported include PDF, PCL, PS, SVG, XML (area tree representation), Print, AWT, MIF and TXT. The primary output target is PDF."></a>
</div>
<!--+
    |end Project Logo
    +-->
<!--+
    |start Search
    +-->
<div class="searchbox">
<form action="http://www.google.com/search" method="get" class="roundtopsmall">
<input value="xmlgraphics.apache.org" name="sitesearch" type="hidden"><input onFocus="getBlank (this, 'Search the site with google');" size="25" name="q" id="query" type="text" value="Search the site with google">&nbsp; 
                    <input name="Search" value="Search" type="submit">
</form>
</div>
<!--+
    |end search
    +-->
<!--+
    |start Tabs
    +-->
<ul id="tabs">
<li>
<a class="unselected" href="../../index.html">Home</a>
</li>
<li>
<a class="unselected" href="../../0.94/index.html">Version 0.94</a>
</li>
<li>
<a class="unselected" href="../../0.95/index.html">Version 0.95</a>
</li>
<li>
<a class="unselected" href="../../trunk/index.html">FOP Trunk</a>
</li>
<li class="current">
<a class="selected" href="../../dev/index.html">Development</a>
</li>
</ul>
<!--+
    |end Tabs
    +-->
</div>
</div>
<div id="main">
<div id="publishedStrip">
<!--+
    |start Subtabs
    +-->
<div id="level2tabs"></div>
<!--+
    |end Endtabs
    +-->
<script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
</div>
<!--+
    |breadtrail
    +-->
<div class="breadtrail">
<a href="http://www.apache.org/">apache.org</a> &gt; <a href="http://xml.apache.org/">XML Federation</a> &gt; <a href="http://xmlgraphics.apache.org/">xmlgraphics.apache.org</a><script src="../../skin/breadcrumbs.js" language="JavaScript" type="text/javascript"></script>
</div>
<!--+
    |start Menu, mainarea
    +-->
<!--+
    |start Menu
    +-->
<div id="menu">
<div onclick="SwitchMenu('menu_1.1', '../../skin/')" id="menu_1.1Title" class="menutitle">About</div>
<div id="menu_1.1" class="menuitemgroup">
<div class="menuitem">
<a href="../../dev/index.html">Basics</a>
</div>
</div>
<div onclick="SwitchMenu('menu_selected_1.2', '../../skin/')" id="menu_selected_1.2Title" class="menutitle" style="background-image: url('../../skin/images/chapter_open.gif');">Design</div>
<div id="menu_selected_1.2" class="selectedmenuitemgroup" style="display: block;">
<div onclick="SwitchMenu('menu_1.2.1', '../../skin/')" id="menu_1.2.1Title" class="menutitle">About</div>
<div id="menu_1.2.1" class="menuitemgroup">
<div class="menuitem">
<a href="../../dev/design/index.html">Introduction</a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.2.2', '../../skin/')" id="menu_1.2.2Title" class="menutitle">Core Process</div>
<div id="menu_1.2.2" class="menuitemgroup">
<div class="menuitem">
<a href="../../dev/design/startup.html">Startup</a>
</div>
<div class="menuitem">
<a href="../../dev/design/parsing.html">XML Parsing</a>
</div>
<div class="menuitem">
<a href="../../dev/design/fotree.html">FO Tree</a>
</div>
<div class="menuitem">
<a href="../../dev/design/properties.html">Properties</a>
</div>
<div class="menuitem">
<a href="../../dev/design/layout.html">Layout</a>
</div>
<div class="menuitem">
<a href="../../dev/design/breakpos.html">Break Possibility</a>
</div>
<div class="menuitem">
<a href="../../dev/design/areas.html">Area Tree</a>
</div>
<div class="menuitem">
<a href="../../dev/design/renderers.html">Renderers</a>
</div>
</div>
<div onclick="SwitchMenu('menu_selected_1.2.3', '../../skin/')" id="menu_selected_1.2.3Title" class="menutitle" style="background-image: url('../../skin/images/chapter_open.gif');">Miscellaneous</div>
<div id="menu_selected_1.2.3" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="../../dev/design/images.html">Images</a>
</div>
<div class="menuitem">
<a href="../../dev/design/pdf-library.html">PDF Library</a>
</div>
<div class="menupage">
<div class="menupagetitle">SVG</div>
</div>
<div class="menuitem">
<a href="../../dev/design/embedding.html">Embedding</a>
</div>
<div class="menuitem">
<a href="../../dev/design/extending.html">Extending</a>
</div>
<div class="menuitem">
<a href="../../dev/design/optimise.html">Optimisations</a>
</div>
<div class="menuitem">
<a href="../../dev/design/useragent.html">User Agent</a>
</div>
</div>
<div class="menuitem">
<a href="http://wiki.apache.org/xmlgraphics-fop/FOPProjectPages">Unresolved (Wiki)</a>
</div>
<div class="menuitem">
<a href="../../dev/svg.html">SVG</a>
</div>
<div class="menuitem">
<a href="../../dev/extensions.html">Extensions</a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.3', '../../skin/')" id="menu_1.3Title" class="menutitle">Develop</div>
<div id="menu_1.3" class="menuitemgroup">
<div class="menuitem">
<a href="../../dev/api-doc.html">API Doc</a>
</div>
<div class="menuitem">
<a href="../../dev/implement.html">Walk-Thru</a>
</div>
<div class="menuitem">
<a href="http://issues.apache.org/bugzilla/buglist.cgi?bug_status=NEW&bug_status=ASSIGNED&bug_status=REOPENED&email1=&emailtype1=substring&emailassigned_to1=1&email2=&emailtype2=substring&emailreporter2=1&bugidtype=include&bug_id=&changedin=&votes=&chfieldfrom=&chfieldto=Now&chfieldvalue=&product=Fop&short_desc=%5BPATCH%5D&short_desc_type=allwordssubstr&long_desc=&long_desc_type=allwordssubstr&bug_file_loc=&bug_file_loc_type=allwordssubstr&keywords=&keywords_type=anywords&field0-0-0=noop&type0-0-0=noop&value0-0-0=&namedcmd=Fop+all&newqueryname=fop+patch+queue&tofooter=1&order=Reuse+same+sort+as+last+time">Patch Queue</a>
</div>
<div class="menuitem">
<a href="../../dev/conventions.html">Conventions</a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.4', '../../skin/')" id="menu_1.4Title" class="menutitle">Test</div>
<div id="menu_1.4" class="menuitemgroup">
<div class="menuitem">
<a href="../../dev/testing.html">Testing</a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.5', '../../skin/')" id="menu_1.5Title" class="menutitle">Deploy</div>
<div id="menu_1.5" class="menuitemgroup">
<div class="menuitem">
<a href="../../dev/doc.html">Doc Mgmt</a>
</div>
<div class="menuitem">
<a href="../../dev/release.html">Release</a>
</div>
<div class="menuitem">
<a href="http://issues.apache.org/bugzilla/buglist.cgi?bug_status=NEW&bug_status=ASSIGNED&bug_status=REOPENED&email1=&emailtype1=substring&emailassigned_to1=1&email2=&emailtype2=substring&emailreporter2=1&bugidtype=include&bug_id=&changedin=&votes=&chfieldfrom=&chfieldto=Now&chfieldvalue=&product=Fop&short_desc=&short_desc_type=allwordssubstr&long_desc=&long_desc_type=allwordssubstr&bug_file_loc=&bug_file_loc_type=allwordssubstr&keywords=&keywords_type=anywords&field0-0-0=noop&type0-0-0=noop&value0-0-0=&order=bugs.component">Bugs</a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.6', '../../skin/')" id="menu_1.6Title" class="menutitle">Resources</div>
<div id="menu_1.6" class="menuitemgroup">
<div class="menuitem">
<a href="../../dev/faq.html">FAQs</a>
</div>
<div class="menuitem">
<a href="../../dev/tools.html">Tools</a>
</div>
<div class="menuitem">
<a href="http://svn.apache.org/viewvc/xmlgraphics/fop">ViewVC</a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.7', '../../skin/')" id="menu_1.7Title" class="menutitle">SubPackages</div>
<div id="menu_1.7" class="menuitemgroup">
<div class="menuitem">
<a href="../../dev/rtflib.html">RTFlib</a>
</div>
</div>
<div id="credit"></div>
<div id="roundbottom">
<img style="display: none" class="corner" height="15" width="15" alt="" src="../../skin/images/rc-b-l-15-1body-2menu-3menu.png"></div>
<!--+
  |alternative credits
  +-->
<div id="credit2"></div>
</div>
<!--+
    |end Menu
    +-->
<!--+
    |start content
    +-->
<div id="content">
<div title="raw XML" class="xmllink">
<a class="dida" href="svg.xml"><img alt="XML - icon" src="../../skin/images/xmldoc.gif" class="skin"><br>
        XML</a>
</div>
<div title="Portable Document Format" class="pdflink">
<a class="dida" href="svg.pdf"><img alt="PDF -icon" src="../../skin/images/pdfdoc.gif" class="skin"><br>
        PDF</a>
</div>
<div class="trail">Font size: 
	          &nbsp;<input value="Reset" class="resetfont" title="Reset text" onclick="ndeSetTextSize('reset'); return false;" type="button">      
	          &nbsp;<input value="-a" class="smallerfont" title="Shrink text" onclick="ndeSetTextSize('decr'); return false;" type="button">
	          &nbsp;<input value="+a" class="biggerfont" title="Enlarge text" onclick="ndeSetTextSize('incr'); return false;" type="button">
</div>
<h1>FOP Design: SVG</h1>
<div id="front-matter">
<div id="minitoc-area">
<ul class="minitoc">
<li>
<a href="#intro">Introduction</a>
</li>
<li>
<a href="#Text+Drawing">Text Drawing</a>
</li>
<li>
<a href="#PDF+Links">PDF Links</a>
</li>
<li>
<a href="#Images">Images</a>
</li>
<li>
<a href="#PDF+Transcoder">PDF Transcoder</a>
</li>
<li>
<a href="#Other+Outputs">Other Outputs</a>
</li>
</ul>
</div>
</div>

<a name="N10011"></a><a name="intro"></a>
<h2 class="underlined_10">Introduction</h2>
<div class="section">
<p>SVG is rendered through Batik.</p>
<p>The XML from the XSL:FO document
      is converted into an SVG DOM with batik. This DOM is then set as the Document
      on the Foreign Object area in the Area Tree.</p>
<p>This DOM is then available to
      be rendered by the renderer.</p>
<p>SVG is rendered in the renderers via an      XMLHandler in the FOUserAgent. This XML handler is used to render the SVG. The
      SVG is rendered by using batik. Batik converts the SVG DOM into an internal
      structure that can be drawn into a Graphics2D. So for PDF we use a
      PDFGraphics2D to draw into.</p>
<p>This creates the necessary PDF information to
      create the SVG image in the PDF document.</p>
<p>Most of the work is done in the
      PDFGraphics2D class. There are also a few bridges that are plugged into batik
      to provide different behaviour for some SVG elements.</p>
</div>

<a name="N10025"></a><a name="Text+Drawing"></a>
<h2 class="underlined_10">Text Drawing</h2>
<div class="section">
<p>Normally batik converts text into a set of curved
       shapes. </p>
<p>This is handled as any other shapes when rendering to the output. This
       is not always desirable as the shapes have very fine curves. This can cause the
       output to look a bit bad in PDF and PS (it can be drawn properly but is not by
       default). These curves also require much more data than the original
       text.</p>
<p>To handle this there is a PDFTextElementBridge that is set when
       using the bridge in batik. If the text is simple enough for the text to be
       drawn in the PDF as with all other text then this sets the TextPainter to use
       the PDFTextPainter. This inserts the text directly into the PDF using the       drawString method on the PDFGraphics2D.</p>
<p>Text is considered simple if the
       font is available, the font size is useable and there are no tspans or other
       complications. This can make the resulting PDF significantly
       smaller.</p>
</div>

<a name="N10035"></a><a name="PDF+Links"></a>
<h2 class="underlined_10">PDF Links</h2>
<div class="section">
<p>To support links in PDF another batik
       element bridge is used. The PDFAElementBridge creates a PDFANode which inserts
       a link into the PDF document via the PDFGraphics2D.</p>
<p>Since links are       positioned on the page without any transforms then we need to transform the
       coordinates of the link area so that they match the current position of the a
       element area. This transform may also need to account for the svg being
       positioned on the page.</p>
</div>

<a name="N10041"></a><a name="Images"></a>
<h2 class="underlined_10">Images</h2>
<div class="section">
<p>Images are normally drawn
       into the PDFGraphics2D. This then creates a bitmap of the image data that can
       be inserted into the PDF document. </p>
<p>As PDF can support jpeg images then another
       element bridge is used so that the jpeg can be directly inserted into the       PDF.</p>
</div>

<a name="N1004D"></a><a name="PDF+Transcoder"></a>
<h2 class="underlined_10">PDF Transcoder</h2>
<div class="section">
<p>Batik provides a mechanism to
       convert SVG into various formats. Through FOP we can convert an SVG document
       into a single paged PDF document. The page contains the SVG drawn as best as
       possible on the page. There is a PDFDocumentGraphics2D that creates a
       standalone PDF document with a single page. This is then drawn into by batik in
       the same way as with the PDFGraphics2D.</p>
</div>

<a name="N10057"></a><a name="Other+Outputs"></a>
<h2 class="underlined_10">Other Outputs</h2>
<div class="section">
<p>When rendering to AWT the SVG is simply drawn onto the
       awt canvas using batik.</p>
<p>The PS Renderer uses a similar technique as the
       PDF Renderer.</p>
<p>The SVG Renderer simply embeds the SVG inside an svg
       element.</p>
</div>

    
<span class="version">
          version 627324</span>
</div>
<!--+
    |end content
    +-->
<div class="clearboth">&nbsp;</div>
</div>
<div id="footer">
<!--+
    |start bottomstrip
    +-->
<div class="lastmodified">
<script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
</div>
<div class="copyright">
        Copyright &copy;
         1999-2008 <a href="http://www.apache.org/licenses/">The Apache Software Foundation.</a>
</div>
<!--+
    |end bottomstrip
    +-->
</div>
</body>
</html>
