----------------------------------------------------------------------------------------------------
@@JvFtpGrabber.pas
Note:
<B>Delphi Versions:</B> <COLOR Brown>5, 6</COLOR> <B> 

C++ Builder Versions:</B> <COLOR Brown>none</COLOR>

Conditions:
The contents of this file are subject to the Mozilla Public License Version 1.1 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.mozilla.org/MPL/MPL-1.1.html

Author:
Sébastien Buysse

Version:
1.20 Beta

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber
Description:
This component is able to download a file on a ftp server in a separated thread. In other words, it will download a file from the web without disturbing your Application. It will only tell you the progression, the possible errors and when it has finished. 
To use this component with C++Builder, you have to add WinInet.lib to your project !!! (currently C++Builder is not supported)

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.FAgent

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.FFileName

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.FMode

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.FOnClosed

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.FOnClosing

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.FOnConnected

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.FOnConnecting

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.FOnDoneFile

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.FOnDoneStream

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.FOnError

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.FOnProgress

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.FOnReceived

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.FOnReceiving

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.FOnRedirect

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.FOnRequest

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.FOnResolved

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.FOnResolving

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.FOnSending

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.FOnSent

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.FOnStateChange

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.FOutputMode

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.FPassword

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.FThread

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.FUrl

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.FUserName

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.Create@TComponent

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.Destroy

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.DoneFile@TObject@string@Integer@string

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.DoneStream@TObject@TStream@Integer@string

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.Error@TObject@string

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.Execute
Description:
Call this method to start downloading the given URL.

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.Progress@TObject@Integer@string

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.Status@TObject@Integer@string

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.ThreadFinished@TObject

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.Agent
Description:
This property contains the agent sended to the web server. The agent identifies the application connecting to the server (You can simulate you are Internet Explorer or Netscape).

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.FileName
Description:
This property contains the name of the file in which the data is saved. If you want to use a stream instead, you must set the OutputMode to omStream. When the filename has been created and saved, the event OnDoneFile is fired.

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.Mode
Description:
This property specify the download mode of the file. It can be either ascii or binary. If it's ascii, carriage returns are converted for the current os. Don't use an ascii mode for a zip, exe or other similar file type, or the file will be corrupted!

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.OnClosedConnection
Description:
This event is called when the connection with the server has been closed.

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.OnClosingConnection
Description:
This event is called when the connection with the server is about to be closed.

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.OnConnectedToServer
Description:
This event is called when the connection with the server has been established.

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.OnConnectingToServer
Description:
This event is called when the connection with the server is about to be started.

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.OnDoneFile
Description:
This event is called when the file has been successfully dowloaded and saved to a file. This event is only called when you have set the OutputMode to omFile.

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.OnDoneStream
Description:
This event is called when the file has been successfully downloaded and saved to a stream. This event is only called when you have set the OutputMode to omStream

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.OnError
Description:
This event is called when an error occured. The error can be either a problem with the connection, an inexistant server or any other error. The download is automatically aborted.

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.OnProgress
Description:
This event is called when some bytes of the file have been downloaded. This event is the most usefull one to display progression bar, to compute time remaining, etc.

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.OnReceivedResponse
Description:
This event is called when the server has finished sending the file.

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.OnReceivingResponse
Description:
This event is called when the server has started sending the answer

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.OnRedirect
Description:
This event is called when the web server is redirecting your request to another url. This event will give you the new url.

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.OnRequestComplete
Description:
This event is called when the request you have sent has been successfully completed.

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.OnRequestSent
Description:
This event is called when the request has been completly sent

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.OnResolvedName
Description:
This event is called when the hostname has been successfully translated into his address. The request is now going to be processed.

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.OnResolvingName
Description:
This event is called when the hostname is going to be translated into his address. When this request is terminated, the event OnResolvedName is fired.

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.OnSendingRequest
Description:
This event is called when the request is going to be sent to server.

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.OnStateChange
Description:
This event is called when the connection state has changed (offline/online)

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.OutputMode
Description:
This property specify the destination of the downloaded file. It can be either a stream or a file.
 If you want to save it to a stream, set this property to omStream, then, when the file will be downloaded, the event OnDoneStream will be fired.
 If you want to save it directly to a file, set this property to omFile and specify a valid filename in the property FileName (The event OnDoneFile will be fired when the file has been created)

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.Password
Description:
This property contains the password used to identify yourself on the server. If no password has to be given, just left this property blank.

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.Url
Description:
This property contains the url you want to download. The url must be of the type ftp://ftp.yourserver.com/directory/thefile.ext. After assigning this property, you must call the Download method to start the download of the file. Don't forget to set Mode to hmBinary if you are download an exe, a zip,...

----------------------------------------------------------------------------------------------------
@@TJvFtpGrabber.Username
Description:
This property contains the username used to identify yourself on the server. If no username has to be given, just left this property blank.

----------------------------------------------------------------------------------------------------
@@TJvFtpThread

----------------------------------------------------------------------------------------------------
@@TJvFtpThread.FAgent

----------------------------------------------------------------------------------------------------
@@TJvFtpThread.FBytesReaded

----------------------------------------------------------------------------------------------------
@@TJvFtpThread.FErrorText

----------------------------------------------------------------------------------------------------
@@TJvFtpThread.FFileName

----------------------------------------------------------------------------------------------------
@@TJvFtpThread.FMode

----------------------------------------------------------------------------------------------------
@@TJvFtpThread.FOnDoneFile

----------------------------------------------------------------------------------------------------
@@TJvFtpThread.FOnDoneStream

----------------------------------------------------------------------------------------------------
@@TJvFtpThread.FOnError

----------------------------------------------------------------------------------------------------
@@TJvFtpThread.FOnProgress

----------------------------------------------------------------------------------------------------
@@TJvFtpThread.FOnStatus

----------------------------------------------------------------------------------------------------
@@TJvFtpThread.FOutputMode

----------------------------------------------------------------------------------------------------
@@TJvFtpThread.FPassword

----------------------------------------------------------------------------------------------------
@@TJvFtpThread.FUrl

----------------------------------------------------------------------------------------------------
@@TJvFtpThread.FUserName

----------------------------------------------------------------------------------------------------
@@TJvFtpThread.Stream

----------------------------------------------------------------------------------------------------
@@TJvFtpThread.Create@string@string@string@string@TJvOutputMode@TOnError@TOnDoneFile@TOnDoneStream@

----------------------------------------------------------------------------------------------------
@@TJvFtpThread.Ended

----------------------------------------------------------------------------------------------------
@@TJvFtpThread.Error

----------------------------------------------------------------------------------------------------
@@TJvFtpThread.Execute

----------------------------------------------------------------------------------------------------
@@TJvFtpThread.GetLastErrorMsg

----------------------------------------------------------------------------------------------------
@@TJvFtpThread.Progress

----------------------------------------------------------------------------------------------------
@@TJvDownloadMode

