apply plugin: 'com.android.library'

android {
    compileSdkVersion 27
    buildToolsVersion "27.0.3"

    defaultConfig {
        minSdkVersion 15
        targetSdkVersion 27

        if (project.hasProperty("build.number")) {
            versionCode project.ext['build_counter'] as Integer // Because TeamCity does not bubble build.counter into system properties...
            versionName "${project.ext['build.number']}"
        } else {
            String majorMinorVersion = file('$projectDir/../../../../resources/VERSION.md').text.trim()
            versionCode 100
            versionName majorMinorVersion + '.0.0'
        }
    }

    buildTypes {
        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.txt'
        }
    }

    testOptions {
        unitTests {
            // Allows use of a simulated Android API for tests.  (Thanks, roboelectric!)
            includeAndroidResources = true
        }
        unitTests.all {
            testLogging {
                // May also add "passed", "skipped".
                events "failed"//, "standardOut", "standardError" if we want them to show in builds.
                outputs.upToDateWhen {false}
                //showStandardStreams = true // If we want test console log output to show during builds.
            }
            workingDir = "../" // Defaults to the `app` subdirectory, which is different from Android Studio's default.
        }
    }
}

ext {
    currentFirebaseVersion = "15.0.2"
}

dependencies {
    implementation 'com.android.support:appcompat-v7:27.1.1'
    implementation 'com.android.support:design:27.1.1'
    implementation 'commons-io:commons-io:2.6'
    implementation 'org.apache.commons:commons-text:1.2'
    testImplementation 'junit:junit:4.12'
    testImplementation "org.robolectric:robolectric:3.8"

    /* We only want these Firebase Crashlytics dependencies for KMEA */
    implementation "com.google.firebase:firebase-analytics:$currentFirebaseVersion"
    implementation "com.google.firebase:firebase-crash:$currentFirebaseVersion"
    implementation('com.crashlytics.sdk.android:crashlytics:2.9.2@aar') {
        transitive = true;
    }
}
